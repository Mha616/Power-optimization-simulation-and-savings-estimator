clc;
clear;
close all;
cost_redy = [];
yadem =[];
ydem =[];
encosty = 0;
aencosty = 0;
for j = 1:12
    maxwdem = [];
    amaxwdem = [];
    aenergyconm = 0;
    energyconm =0;
    for i=1:4
        tod = 1:1:96;%15 min intervals throuout the day
        windcap = 0;
        acdem_mon = [ 71.12 73.73 48.45 66.05 55.14 62.98 61.13 61.90 58.06 57.44 55.14 56.37 55.76 54.83 56.52 55.91 56.83 50.99 53.45 47.00 97.54 151.60 175.56 227.48 269.26 262.96 275.56 274.94 274.33 262.96 270.03 278.94 270.80 255.74 286.92 294.91 296.45 303.20 314.26 316.11 314.11 319.49 312.11 294.45 302.90 317.34 317.80 320.26 323.02 330.85 328.09 337.30 338.22 332.08 334.08 299.21 341.14 356.66 352.36 358.81 343.30 335.46 344.98 332.24 290.30 192.77 141.00 133.32 135.63 129.79 132.40 131.17 120.11 126.41 115.97 113.36 112.59 103.83 106.75 99.68 98.61 98.46 92.46 92.46 82.79 83.56 78.95 79.10 78.49 78.80 74.96 75.11 75.11 76.95 73.26 54.83]; % demand across monday
        winp =[windcap*((0.8-0.5)*rand(1,96)+.5)]; % wind power throughout the day
        solp = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 9.86 25.81 42.45 60.53 91.63 100.28 107.15 109.90 110.13 112.32 112.54 115.87 119.47 120.41 125.72 129.92 132.59 141.01 148.63 150 150 150 150 150 150 150 150 150 150 150 150 150 150 150 147.52 142.80 138.10 133.02 121.23 112.10 105.29 101.38 96.47 95.82 92.12 75.65 60.54 48.64 36.44 22.98 8.77 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0].*((1-0.8)*rand(1,96)+.8);% solar power generated throughout the day
        netdem_mon = acdem_mon - winp -solp;
        aenergycon_mon = sum(acdem_mon)*0.25;
        energycon_mon = sum(netdem_mon)*0.25;
        acdem_tue = [71.12 73.73 65.12 66.05 55.14 62.98 61.13 61.90 58.06 57.44 55.14 56.37 55.76 54.83 56.52 55.91 56.83 50.99 53.45 47.00 40.55 71.42 159.59 180.63 218.88 256.51 275.56 270.80 274.33 254.05 264.65 278.94 270.80 253.59 265.73 286.92 294.91 296.45 301.98 314.26 309.96 314.11 319.49 312.11 279.86 282.16 309.35 317.80 308.58 313.04 330.85 328.09 323.02 322.56  329.93 323.33 299.21 328.40 313.50 302.44 301.52 302.44 293.68 296.91 284.77 235.47 161.74 115.81 110.90 99.84 99.99 109.36 98.61 99.68 96.77 97.54 98.15 92.62 87.24 85.09 83.10 81.41 81.41 81.25 75.26 63.59 55.45 69.58 58.06 61.13 58.98 58.52 56.22 61.90 54.22 56.22];%demand across tuesday 
        winp =[windcap*((0.8-0.5)*rand(1,96)+.5)]; % wind power throughout the day
        solp = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 9.86 25.81 42.45 60.53 91.63 100.28 107.15 109.90 110.13 112.32 112.54 115.87 119.47 120.41 125.72 129.92 132.59 141.01 148.63 150 150 150 150 150 150 150 150 150 150 150 150 150 150 150 147.52 142.80 138.10 133.02 121.23 112.10 105.29 101.38 96.47 95.82 92.12 75.65 60.54 48.64 36.44 22.98 8.77 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0].*((1-0.8)*rand(1,96)+.8);% solar power generated throughout the day
        netdem_tue = acdem_tue - winp -solp;
        aenergycon_tue = sum(acdem_tue)*0.25;
        energycon_tue = sum(netdem_tue)*0.25;
        acdem_wed = [54.68 53.30 50.99 50.69 52.84 52.07 56.37 49.00 47.31 50.84 50.38 45.00 32.87 33.79 32.26 39.94 32.56 36.71 35.48 28.72 33.94 102.45 138.08 158.21 215.65 259.58 272.18 274.94 272.33 261.73 270.03 278.78 266.19 247.76 260.96 286.31 273.87 286.77 303.20 306.58 316.11 303.82 294.45 301.21 276.17 276.48 301.52 311.19 320.26 323.02 319.02 311.96 337.30 335.77 320.72 321.64 285.08 298.90 325.17 334.69 345.14 322.25 320.41 317.95 307.66 272.64 192.77 137.62 129.18 135.63 129.79 125.95 124.57 120.11 114.74 103.98 96.61 90.32 83.40 76.64 72.80 70.81 73.57 71.27 65.12 70.35 69.12 65.28 52.84 53.45 55.76 52.68 47.31 52.53 51.15 51.15];%demand across wednesday
        winp =[windcap*((0.8-0.5)*rand(1,96)+.5)]; % wind power throughout the day
        solp = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 9.86 25.81 42.45 60.53 91.63 100.28 107.15 109.90 110.13 112.32 112.54 115.87 119.47 120.41 125.72 129.92 132.59 141.01 148.63 150 150 150 150 150 150 150 150 150 150 150 150 150 150 150 147.52 142.80 138.10 133.02 121.23 112.10 105.29 101.38 96.47 95.82 92.12 75.65 60.54 48.64 36.44 22.98 8.77 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0].*((1-0.8)*rand(1,96)+.8);% solar power generated throughout the day
        netdem_wed = acdem_wed - winp -solp;
        aenergycon_wed = sum(acdem_wed)*0.25;
        energycon_wed = sum(netdem_wed)*0.25;
        acdem_thu = [31.79 37.48 28.11 39.01 36.25 37.32 38.40 30.56 41.01 35.48 34.71 33.02 37.17 29.03 34.56 29.34 32.10 31.95 30.10 30.10 29.49 94.31 126.72 131.33 139.47 158.21 158.21 162.35 151.60 161.12 159.59 167.42 172.18 160.97 173.57 174.64 166.81 180.32 183.09 182.17 182.78 186.93 175.87 172.95 159.44 160.97 171.11 167.73 168.19 174.95 187.70 189.85 181.40 166.96 170.96 183.40 193.69 159.90 103.06 78.80 84.63 83.86 84.94 82.18 80.64 66.82 53.60 54.83 45.92 46.23 44.39 45.77 43.62 39.01 43.31 41.47 43.01 45.31 44.39 48.69 44.24 44.08 39.17 37.48 43.47 37.78 39.01 43.62 43.93 40.55 42.08 40.70 42.39 42.70 39.78 38.70];%demand across
        winp =[windcap*((0.8-0.5)*rand(1,96)+.5)]; % wind power throughout the day
        solp = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 9.86 25.81 42.45 60.53 91.63 100.28 107.15 109.90 110.13 112.32 112.54 115.87 119.47 120.41 125.72 129.92 132.59 141.01 148.63 150 150 150 150 150 150 150 150 150 150 150 150 150 150 150 147.52 142.80 138.10 133.02 121.23 112.10 105.29 101.38 96.47 95.82 92.12 75.65 60.54 48.64 36.44 22.98 8.77 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0].*((1-0.8)*rand(1,96)+.8);% solar power generated throughout the day
        netdem_thu = acdem_thu - winp -solp;
        aenergycon_thu = sum(acdem_thu)*0.25;
        energycon_thu = sum(netdem_thu)*0.25;
        acdem_fri= [40.40 36.71 39.01 45.62 44.70 37.78 40.70 39.17 36.40 35.63 37.94 33.64 36.86 37.32 40.70 38.24 33.94 39.47 38.40 38.86 40.86 36.10 31.33 35.94 33.94 37.94 33.48 40.70 32.56 33.33 32.56 39.63 37.17 54.83 57.29 53.91 46.69 45.77 50.53 63.28 62.67 59.14 56.98 61.74 66.66 63.74 75.72 81.25 79.26 85.55 83.56 83.56 84.78 89.55 91.24 92.62 88.93 89.09 91.70 94.77 95.84 97.38 95.84 94.00 92.00 93.23 97.84 98.92 95.84 94.00 92.31 93.85 90.32 93.54 88.16 89.70 84.78 84.17 84.17 80.79 83.40 84.02 80.33 73.57 63.74 64.82 67.28 68.04 65.58 67.58 66.51 59.60 57.60 57.14 48.69 54.83];
        winp =[windcap*((0.8-0.5)*rand(1,96)+.5)]; % wind power throughout the day
        solp = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 9.86 25.81 42.45 60.53 91.63 100.28 107.15 109.90 110.13 112.32 112.54 115.87 119.47 120.41 125.72 129.92 132.59 141.01 148.63 150 150 150 150 150 150 150 150 150 150 150 150 150 150 150 147.52 142.80 138.10 133.02 121.23 112.10 105.29 101.38 96.47 95.82 92.12 75.65 60.54 48.64 36.44 22.98 8.77 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0].*((1-0.8)*rand(1,96)+.8);% solar power generated throughout the day
        netdem_fri = acdem_fri - winp -solp;
        aenergycon_fri = sum(acdem_fri)*0.25;
        energycon_fri = sum(netdem_fri)*0.25;
        acdem_sat= [44.70 43.78 36.86 37.78 37.94 39.01 33.33 36.86 39.32 32.26 29.80 36.86 35.79 32.26 29.18 35.79 30.26 32.72 27.65 33.48 27.65 33.02 27.49 31.49 33.33 37.32 34.40 27.80 28.72 35.63 33.18 37.02 31.02 37.63 39.94 42.39 49.00 52.07 52.22 53.91 60.06 59.44 67.28 76.34 72.04 76.49 78.64 79.10 83.86 83.10 89.86 90.62 91.08 85.25 82.48 77.26 80.18 81.87 87.09 88.47 88.32 86.32 87.40 92.77 92.77 90.62 81.25 78.95 80.48 81.25 80.18 81.56 86.78 85.55 83.86 81.56 80.94 78.03 78.80 78.49 81.25 81.41 78.03 58.06 64.20 53.45 59.60 56.52 56.98 50.38 49.46 43.93 54.06 47.31 43.47 52.68];
        winp =[windcap*((0.8-0.5)*rand(1,96)+.5)]; % wind power throughout the day
        solp = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 9.86 25.81 42.45 60.53 91.63 100.28 107.15 109.90 110.13 112.32 112.54 115.87 119.47 120.41 125.72 129.92 132.59 141.01 148.63 150 150 150 150 150 150 150 150 150 150 150 150 150 150 150 147.52 142.80 138.10 133.02 121.23 112.10 105.29 101.38 96.47 95.82 92.12 75.65 60.54 48.64 36.44 22.98 8.77 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0].*((1-0.8)*rand(1,96)+.8);% solar power generated throughout the day
        netdem_sat = acdem_sat - winp -solp;
        aenergycon_sat = sum(acdem_sat)*0.25;
        energycon_sat = sum(netdem_sat)*0.25;
        acdem_sun= [48.69 45.62 43.16 38.09 46.23 45.16 43.47 40.70 41.78 35.79 35.02 38.86 35.94 37.78 37.78 30.10 31.49 38.55 35.79 33.79 40.24 37.02 33.18 31.33 29.64 35.33 27.95 32.56 24.42 34.10 38.09 36.56 32.72 30.26 32.41 38.09 45.62 51.61 48.23 54.37 54.37 53.91 67.58 71.58 69.73 74.19 81.41 81.71 85.40 90.47 89.24 83.56 85.25 86.94 95.38 94.00 97.07 90.47 95.84 94.00 98.00 98.30 101.07 95.38 94.77 90.16 95.84 96.46 102.91 98.15 96.61 93.70 92.00 88.78 89.24 88.47 88.93 80.94 81.56 79.72 78.49 76.49 79.87 74.03 68.35 64.20 57.90 64.51 64.36 57.29 55.60 59.90 52.68 54.53 43.31 45.16];
        winp =[windcap*((0.8-0.5)*rand(1,96)+.5)]; % wind power throughout the day
        solp = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 9.86 25.81 42.45 60.53 91.63 100.28 107.15 109.90 110.13 112.32 112.54 115.87 119.47 120.41 125.72 129.92 132.59 141.01 148.63 150 150 150 150 150 150 150 150 150 150 150 150 150 150 150 147.52 142.80 138.10 133.02 121.23 112.10 105.29 101.38 96.47 95.82 92.12 75.65 60.54 48.64 36.44 22.98 8.77 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0].*((1-0.8)*rand(1,96)+.8);% solar power generated throughout the day
        netdem_sun = acdem_sun - winp -solp;
        aenergycon_sun = sum(acdem_sun)*0.25;
        energycon_sun = sum(netdem_sun)*0.25;
        amaxmon = max(acdem_mon);
        amaxtue = max(acdem_tue);
        amaxwed = max(acdem_wed);
        amaxthu = max(acdem_thu);
        amaxfri = max(acdem_fri);
        amaxsat = max(acdem_sat);
        amaxsun = max(acdem_sun);
        amaxwdem =[amaxwdem max([amaxmon amaxtue amaxwed amaxthu amaxfri amaxsat amaxsun])];
        maxmon = max(netdem_mon);
        maxtue = max(netdem_tue);
        maxwed = max(netdem_wed);
        maxthu = max(netdem_thu);
        maxfri = max(netdem_fri);
        maxsat = max(netdem_sat);
        maxsun = max(netdem_sun);
        maxwdem =[maxwdem max([maxmon maxtue maxwed maxthu maxfri maxsat maxsun])];
        aenergyconw =aenergycon_mon + aenergycon_tue + aenergycon_wed + aenergycon_thu + aenergycon_fri + aenergycon_sat + aenergycon_sun;
        aenergyconm = aenergyconm+ aenergyconw;
        energyconw =energycon_mon + energycon_tue + energycon_wed + energycon_thu + energycon_fri+ energycon_sat + energycon_sun;
        energyconm = energyconm+ energyconw;
    end 
    amaxmdem = max(amaxwdem);
    maxmdem = max(maxwdem);
    adem_cost = amaxmdem*10.22;
    aenergy_cost = aenergyconm*0.0457;
    aencosty = aencosty +aenergy_cost;
    dem_cost = maxmdem*10.22;
    energy_cost = energyconm*0.0457;
    encosty = encosty + energy_cost;
    dem_red = amaxmdem - maxmdem;
    energy_red = aenergyconm - energyconm;
    acost = adem_cost+aenergy_cost;
    cost_redm = (dem_red*10.22)+(energy_red*0.0457);
    cost_redy = [cost_redy cost_redm];
    ydem = [ydem maxmdem];
    yadem = [yadem amaxmdem];
end
yearly_cost_red = sum(cost_redy);